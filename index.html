<!DOCTYPE html>
<html lang="de-CH">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Wort-Sammler Pro</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#121212">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%23121212'/><text x='50%' y='50%' dominant-baseline='central' text-anchor='middle' font-family='sans-serif' font-size='60' fill='%238AB4F8'>W</text></svg>">

    <style>
        /* GOOGLE PIXEL DARK THEME (Material You) */
        :root {
            --bg-color: #121212;
            --surface: #1E1E1E;
            --primary: #8AB4F8; /* Pixel Blue */
            --on-primary: #003063;
            --text-main: #E2E2E2;
            --text-sub: #909090;
            --danger: #F28B82;
            --accent: #D2E3FC;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Roboto', 'Segoe UI', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: env(safe-area-inset-top) 16px 16px 16px;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .screen {
            background: var(--surface);
            padding: 28px;
            border-radius: 32px;
            max-width: 500px;
            margin: 20px auto;
            width: 100%;
            box-shadow: 0 8px 24px rgba(0,0,0,0.4);
        }

        h1 { font-size: 24px; font-weight: 400; text-align: center; color: var(--primary); margin-bottom: 32px; }
        h2 { font-size: 20px; font-weight: 400; margin-bottom: 20px; }

        button {
            width: 100%;
            padding: 16px;
            margin: 8px 0;
            border-radius: 100px; /* Voll abgerundet wie Pixel-Buttons */
            border: none;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: opacity 0.2s, transform 0.1s;
        }

        .btn-primary { background-color: var(--primary); color: var(--on-primary); }
        .btn-outline { background-color: transparent; border: 1px solid var(--text-sub); color: var(--text-main); }
        .btn-delete { background: none; color: var(--danger); border: 1px solid var(--danger); width: auto; padding: 6px 12px; font-size: 12px; }

        button:active { transform: scale(0.97); opacity: 0.8; }

        textarea {
            width: 100%;
            background: #2C2C2C;
            border: 2px solid transparent;
            border-radius: 20px;
            padding: 16px;
            color: white;
            font-size: 16px;
            margin-bottom: 16px;
            outline: none;
        }

        textarea:focus { border-color: var(--primary); }

        .hidden { display: none !important; }

        /* Listen-Design */
        .entry-card {
            border-bottom: 1px solid #333;
            padding: 16px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .entry-info { display: flex; flex-direction: column; gap: 4px; }
        .entry-text { font-weight: 500; font-size: 16px; }
        .entry-meta { font-size: 12px; color: var(--text-sub); }

        #randomDisplay {
            font-size: 22px;
            text-align: center;
            padding: 40px 20px;
            background: #2C2C2C;
            border-radius: 24px;
            margin-bottom: 24px;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>

    <div id="home" class="screen">
        <h1>Wort-Sammler</h1>
        <button class="btn-primary" onclick="showScreen('erfassen')">Neu erfassen</button>
        <button class="btn-outline" onclick="showScreen('ansehen')">Alle Einträge</button>
        <button class="btn-outline" onclick="showScreen('random')">Zufall</button>
    </div>

    <div id="erfassen" class="screen hidden">
        <h2>Eintrag schreiben</h2>
        <textarea id="inputField" rows="5" placeholder="Satz oder Wort..."></textarea>
        <button class="btn-primary" onclick="saveEntry('Wort')">Als Wort senden</button>
        <button class="btn-primary" onclick="saveEntry('Satz')">Als Satz senden</button>
        <button class="btn-outline" onclick="showScreen('home')">Zurück</button>
    </div>

    <div id="ansehen" class="screen hidden">
        <h2>Sammlung</h2>
        <button class="btn-outline" onclick="exportCSV()" style="font-size:14px; padding:10px;">CSV Export</button>
        <div id="listContainer"></div>
        <button class="btn-outline" onclick="showScreen('home')" style="margin-top:20px;">Zurück</button>
    </div>

    <div id="random" class="screen hidden">
        <h2>Zufall</h2>
        <div id="randomDisplay"></div>
        <button class="btn-primary" onclick="displayRandom()">Nächster</button>
        <button class="btn-outline" onclick="showScreen('home')">Zurück</button>
    </div>

    <script>
        let entries = JSON.parse(localStorage.getItem('pixel_words')) || [];

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            if(id === 'ansehen') renderList();
            if(id === 'random') displayRandom();
        }

        function saveEntry(type) {
            const val = document.getElementById('inputField').value.trim();
            if(!val) return;
            const entry = {
                id: Date.now(),
                text: val,
                date: new Date().toLocaleDateString('de-CH'),
                chars: val.length,
                type: type
            };
            entries.unshift(entry);
            localStorage.setItem('pixel_words', JSON.stringify(entries));
            document.getElementById('inputField').value = '';
            showScreen('home');
        }

        function renderList() {
            const container = document.getElementById('listContainer');
            if(entries.length === 0) { container.innerHTML = "<p>Leer.</p>"; return; }
            container.innerHTML = entries.map((e, i) => `
                <div class="entry-card">
                    <div class="entry-info">
                        <span class="entry-text">${e.text}</span>
                        <span class="entry-meta">${e.date} • ${e.chars} Zeichen • ${e.type}</span>
                    </div>
                    <button class="btn-delete" onclick="deleteEntry(${i})">Löschen</button>
                </div>
            `).join('');
        }

        function deleteEntry(i) {
            if(confirm("Löschen?")) { entries.splice(i, 1); localStorage.setItem('pixel_words', JSON.stringify(entries)); renderList(); }
        }

        function displayRandom() {
            const box = document.getElementById('randomDisplay');
            if(entries.length === 0) { box.innerText = "Keine Einträge"; return; }
            box.innerText = entries[Math.floor(Math.random() * entries.length)].text;
        }

        function exportCSV() {
            let csv = "Datum;Eintrag;Typ\n" + entries.map(e => `${e.date};"${e.text}";${e.type}`).join("\n");
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url; a.download = "export.csv"; a.click();
        }

        if ('serviceWorker' in navigator) { navigator.serviceWorker.register('sw.js'); }
    </script>
</body>
</html>
